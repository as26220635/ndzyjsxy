//视图
v_menu

create or replace view v_menu as
select sm.*,SC.SC_NAME from sys_menu sm
LEFT JOIN SYS_CONFIGURE SC ON SC.ID = SM.SC_ID

v_button

create or replace view v_button as
SELECT SB.ID,SB.SB_NAME,SB.SB_BUTTONID,SB.SB_ICON,SB.SB_CODE,SB.SB_ORDER,SB.SB_TYPE,SDI.SDI_NAME SB_TYPE_NAME
FROM sys_button SB
LEFT JOIN sys_dict_info SDI ON SDI.SDT_CODE = 'SYS_BUTTON_TYPE' AND SDI.SDI_CODE = SB.SB_TYPE

v_role

create or replace view v_role as
SELECT SR.ID,SR.SR_TYPE,SR.SR_CODE,SR.SR_NAME,SR.SR_EXPLAIN,SR.SR_REMARK,SR.IS_STATUS FROM sys_role SR

v_configure_column

create or replace view v_configure_column as
SELECT
SCC.ID,SCC.SC_ID,SCC.SCC_NAME,SCC.SCC_FIELD,SCC.SCC_ALIGN,SCC.SCC_WIDTH,SCC.SCC_SDT_CODE,SCC.SCC_IS_OPERATION,SCC.SCC_IS_VISIBLE,SCC.SCC_IS_STATUS,SCC.SCC_ORDER
FROM sys_configure_column SCC

v_configure_search

create or replace view v_configure_search as
SELECT
SCS.ID,SCS.SC_ID,SCS.SCS_NAME,SCS.SCS_FIELD,SCS.SCS_SDT_CODE,SCS.SCS_METHOD_TYPE,SCS.SCS_TYPE,SCS.SCC_IS_VISIBLE,SCS.SCS_ORDER,SCS.SCS_REMARK
FROM sys_configure_search SCS

v_validate

create or replace view v_validate as
select sv.* from sys_validate sv


v_validate_field

CREATE OR REPLACE VIEW V_VALIDATE_FIELD AS
SELECT SVF.*,SVR.SVR_NAME,SVG.SVG_GROUPS FROM SYS_VALIDATE_FIELD SVF
LEFT JOIN SYS_VALIDATE_REGEX SVR ON SVR.ID = SVF.SVR_ID
LEFT JOIN (SELECT SVGF.SVF_ID,GROUP_CONCAT(SVG.SVG_GROUP ORDER BY CONVERT (SVG.ID, SIGNED) ASC) AS SVG_GROUPS FROM SYS_VALIDATE_GROUP SVG INNER JOIN SYS_VALIDATE_GROUP_FIELD SVGF ON SVGF.SVG_ID = SVG.ID GROUP BY SVG.SV_ID,SVGF.SVF_ID ORDER BY CONVERT(SVG.ID,SIGNED) ASC)SVG ON SVF.ID = SVG.SVF_ID

v_validate_regex

create or replace view v_validate_regex as
select svr.* from sys_validate_regex svr

v_validate_group

CREATE OR REPLACE VIEW V_VALIDATE_GROUP AS
SELECT SVG.*,SVGF.SVF_NAMES FROM SYS_VALIDATE_GROUP SVG
LEFT JOIN (SELECT SVGF.SVG_ID,GROUP_CONCAT(SVF.SVF_NAME) AS SVF_NAMES FROM SYS_VALIDATE_GROUP_FIELD SVGF INNER JOIN SYS_VALIDATE_FIELD SVF ON SVF.ID = SVGF.SVF_ID GROUP BY SVGF.SVG_ID)SVGF ON SVGF.SVG_ID = SVG.ID

v_dict_type

create or replace view v_dict_type as
select sdt.* from sys_dict_type sdt

v_dict_info

create or replace view v_dict_info as
select sdi.* from sys_dict_info sdi

v_operator

CREATE OR REPLACE VIEW V_OPERATOR AS
SELECT SO.ID,SO.IS_STATUS,SAI.SAI_NAME,SAI.SAI_PHONE,SAI.SAI_EMAIL,SOS.SOS_USERNAME,SAI.SAI_TYPE
FROM SYS_OPERATOR SO
INNER JOIN SYS_ACCOUNT_INFO SAI ON SAI.SO_ID = SO.ID
LEFT JOIN (SELECT SOS.SO_ID,GROUP_CONCAT(DISTINCT SOS.SOS_USERNAME) AS SOS_USERNAME FROM SYS_OPERATOR_SUB SOS GROUP BY SOS.SO_ID)SOS ON SOS.SO_ID = SO.ID


v_operator_sub

CREATE OR REPLACE VIEW V_OPERATOR_SUB AS
SELECT SOS.* FROM SYS_OPERATOR_SUB SOS

v_format

CREATE OR REPLACE VIEW V_FORMAT AS
SELECT SF.* FROM SYS_FORMAT SF


v_format_detail

CREATE OR REPLACE VIEW V_FORMAT_DETAIL AS
SELECT SFD.*,SM.SM_NAME FROM SYS_FORMAT_DETAIL SFD
LEFT JOIN SYS_MENU SM ON SM.ID = SFD.SM_ID


v_process_definition

CREATE OR REPLACE VIEW V_PROCESS_DEFINITION AS
SELECT SPD.* FROM SYS_PROCESS_DEFINITION SPD


v_process_step

CREATE OR REPLACE VIEW V_PROCESS_STEP AS
SELECT SPS.*,SR.SR_NAME
FROM SYS_PROCESS_STEP SPS
LEFT JOIN SYS_ROLE SR ON SR.ID = SPS.SR_ID


v_process_schedule

CREATE OR REPLACE VIEW V_PROCESS_SCHEDULE AS
SELECT SPS.*,SPD.SPD_NAME,SAI.SAI_NAME AS INITIATOR_NAME,SAIC.SAI_NAME CANCEL_NAME,SPSC.ID AS SPSC_ID,SPSC.SPSC_REASON,SPSC.SPSC_ENTRY_TIME,SDI.SDI_NAME AS PROCESS_STATUS_NAME,SPT.SPS_NAME AS STEP_NAME
FROM SYS_PROCESS_SCHEDULE SPS
LEFT JOIN SYS_PROCESS_STEP SPT ON SPT.ID = SPS.SPS_ID
LEFT JOIN SYS_PROCESS_DEFINITION SPD ON SPD.ID = SPS.SPD_ID
LEFT JOIN SYS_PROCESS_SCHEDULE_CANCEL SPSC ON SPSC.SPS_ID = SPS.ID
LEFT JOIN SYS_ACCOUNT_INFO SAI ON SAI.SO_ID = SPS.SO_ID
LEFT JOIN SYS_ACCOUNT_INFO SAIC ON SAI.SO_ID = SPSC.SO_ID
LEFT JOIN SYS_DICT_INFO SDI ON SDI.SDT_CODE = 'SYS_PROCESS_STATUS' AND SDI.SDI_CODE = SPS.SPS_AUDIT_STATUS

v_division

CREATE OR REPLACE VIEW V_DIVISION AS
SELECT BD.*,PBD.BD_NAME AS BD_PARENT_NAME
FROM BUS_DIVISION BD
LEFT JOIN BUS_DIVISION PBD ON PBD.ID = BD.BD_PARENT_ID

v_division_personnel

CREATE OR REPLACE VIEW V_DIVISION_PERSONNEL AS
SELECT BDP.*,BD.BD_NAME
FROM BUS_DIVISION_PERSONNEL BDP
INNER JOIN BUS_DIVISION BD ON BD.ID = BDP.BD_ID


v_department

CREATE OR REPLACE VIEW V_DEPARTMENT AS
SELECT BDM.*,SDI.SDI_NAME AS BDM_COLLEGE_NAME
FROM BUS_DEPARTMENT BDM
LEFT JOIN SYS_DICT_INFO SDI ON SDI.SDT_CODE ='BUS_COLLEGE' AND SDI.SDI_CODE = BDM.BDM_COLLEGE

v_department_personnel

CREATE OR REPLACE VIEW V_DEPARTMENT_PERSONNEL AS
SELECT BDMP.*,BDM.BDM_NAME
FROM BUS_DEPARTMENT_PERSONNEL BDMP
INNER JOIN BUS_DEPARTMENT BDM ON BDM.ID = BDMP.BDM_ID

v_class

CREATE OR REPLACE VIEW V_CLASS AS
SELECT BC.*,BDM.BDM_NAME,SDI.SDI_NAME AS BC_MAJOR_NAME
FROM BUS_CLASS BC
INNER JOIN BUS_DEPARTMENT BDM ON BDM.ID = BC.BDM_ID
LEFT JOIN SYS_DICT_INFO SDI ON SDI.SDT_CODE ='BUS_MAJOR' AND SDI.SDI_CODE = BC.BC_MAJOR

v_teacher

CREATE OR REPLACE VIEW V_TEACHER AS
SELECT BT.*,BDM.BDM_NAME
FROM BUS_TEACHER BT
INNER JOIN BUS_DEPARTMENT BDM ON BDM.ID = BT.BDM_ID

v_student

CREATE OR REPLACE VIEW V_STUDENT AS
SELECT
			BS.ID,BS.BDM_ID,BS.BC_ID,BS.BS_NAME,BS.BS_NUMBER,BS.BS_LENGTH,BS.BS_ID_CARD,BS.BS_SEX,BS.BS_NATION,BS.SO_ID,
			SDI.SDI_NAME AS BS_SEX_NAME,NDI.SDI_NAME AS BS_NATION_NAME,
			BDM.BDM_NAME,BC.BC_NAME
FROM BUS_STUDENT BS
INNER JOIN BUS_DEPARTMENT BDM ON BDM.ID = BS.BDM_ID
INNER JOIN BUS_CLASS BC ON BC.ID = BS.BC_ID
LEFT JOIN SYS_DICT_INFO SDI ON SDI.SDT_CODE = 'BUS_SEX' AND SDI.SDI_CODE = BS.BS_SEX
LEFT JOIN SYS_DICT_INFO NDI ON NDI.SDT_CODE = 'BUS_NATION' AND NDI.SDI_CODE = BS.BS_NATION

v_student_attendance

CREATE OR REPLACE VIEW V_STUDENT_ATTENDANCE AS
SELECT BSA.*,BS.BS_NAME,BC.BC_NAME
FROM BUS_STUDENT_ATTENDANCE BSA
INNER JOIN BUS_STUDENT BS ON BS.ID = BSA.BS_ID
INNER JOIN BUS_CLASS BC ON BC.ID = BS.BC_ID
