//视图
v_menu

create or replace view v_menu as
select sm.*,SC.SC_NAME from sys_menu sm
LEFT JOIN SYS_CONFIGURE SC ON SC.ID = SM.SC_ID

v_button

create or replace view v_button as
SELECT SB.ID,SB.SB_NAME,SB.SB_BUTTONID,SB.SB_ICON,SB.SB_CODE,SB.SB_ORDER,SB.SB_TYPE,SDI.SDI_NAME SB_TYPE_NAME
FROM sys_button SB
LEFT JOIN sys_dict_info SDI ON SDI.SDT_CODE = 'SYS_BUTTON_TYPE' AND SDI.SDI_CODE = SB.SB_TYPE

v_role

create or replace view v_role as
SELECT SR.ID,SR.SR_TYPE,SR.SR_CODE,SR.SR_NAME,SR.SR_EXPLAIN,SR.SR_REMARK,SR.IS_STATUS FROM sys_role SR

v_configure_column

create or replace view v_configure_column as
SELECT
SCC.ID,SCC.SC_ID,SCC.SCC_NAME,SCC.SCC_FIELD,SCC.SCC_ALIGN,SCC.SCC_WIDTH,SCC.SCC_SDT_CODE,SCC.SCC_IS_OPERATION,SCC.SCC_IS_VISIBLE,SCC.SCC_IS_STATUS,SCC.SCC_ORDER,SCC.SCC_IS_FIXED,SCC.SCC_IS_EXPORT
FROM sys_configure_column SCC

v_configure_search

create or replace view v_configure_search as
SELECT
SCS.ID,SCS.SC_ID,SCS.SCS_NAME,SCS.SCS_FIELD,SCS.SCS_SDT_CODE,SCS.SCS_METHOD_TYPE,SCS.SCS_TYPE,SCS.SCC_IS_VISIBLE,SCS.SCS_ORDER,SCS.SCS_REMARK
FROM sys_configure_search SCS

v_configure_file

create or replace view V_CONFIGURE_FILE as
SELECT
SCF.*,SC.SC_NAME
FROM SYS_CONFIGURE_FILE SCF
INNER JOIN SYS_CONFIGURE SC ON SC.ID = SCF.SC_ID

v_validate

create or replace view v_validate as
select sv.* from sys_validate sv


v_validate_field

CREATE OR REPLACE VIEW V_VALIDATE_FIELD AS
SELECT SVF.*,SVR.SVR_NAME,SVG.SVG_GROUPS FROM SYS_VALIDATE_FIELD SVF
LEFT JOIN SYS_VALIDATE_REGEX SVR ON SVR.ID = SVF.SVR_ID
LEFT JOIN (SELECT SVGF.SVF_ID,GROUP_CONCAT(SVG.SVG_GROUP ORDER BY CONVERT (SVG.ID, SIGNED) ASC) AS SVG_GROUPS FROM SYS_VALIDATE_GROUP SVG INNER JOIN SYS_VALIDATE_GROUP_FIELD SVGF ON SVGF.SVG_ID = SVG.ID GROUP BY SVG.SV_ID,SVGF.SVF_ID ORDER BY CONVERT(SVG.ID,SIGNED) ASC)SVG ON SVF.ID = SVG.SVF_ID

v_validate_regex

create or replace view v_validate_regex as
select svr.* from sys_validate_regex svr

v_validate_group

CREATE OR REPLACE VIEW V_VALIDATE_GROUP AS
SELECT SVG.*,SVGF.SVF_NAMES FROM SYS_VALIDATE_GROUP SVG
LEFT JOIN (SELECT SVGF.SVG_ID,GROUP_CONCAT(SVF.SVF_NAME) AS SVF_NAMES FROM SYS_VALIDATE_GROUP_FIELD SVGF INNER JOIN SYS_VALIDATE_FIELD SVF ON SVF.ID = SVGF.SVF_ID GROUP BY SVGF.SVG_ID)SVGF ON SVGF.SVG_ID = SVG.ID

v_dict_type

create or replace view v_dict_type as
select sdt.* from sys_dict_type sdt

v_dict_info

create or replace view v_dict_info as
select sdi.* from sys_dict_info sdi

v_operator

CREATE OR REPLACE VIEW V_OPERATOR AS
SELECT SO.ID,SO.IS_STATUS,SAI.SAI_NAME,SAI.SAI_PHONE,SAI.SAI_EMAIL,SOS.SOS_USERNAME,SAI.SAI_TYPE
FROM SYS_OPERATOR SO
INNER JOIN SYS_ACCOUNT_INFO SAI ON SAI.SO_ID = SO.ID
LEFT JOIN (SELECT SOS.SO_ID,GROUP_CONCAT(DISTINCT SOS.SOS_USERNAME) AS SOS_USERNAME FROM SYS_OPERATOR_SUB SOS GROUP BY SOS.SO_ID)SOS ON SOS.SO_ID = SO.ID


v_operator_sub

CREATE OR REPLACE VIEW V_OPERATOR_SUB AS
SELECT SOS.* FROM SYS_OPERATOR_SUB SOS

v_format

CREATE OR REPLACE VIEW V_FORMAT AS
SELECT SF.* FROM SYS_FORMAT SF


v_format_detail

CREATE OR REPLACE VIEW V_FORMAT_DETAIL AS
SELECT SFD.*,SM.SM_NAME FROM SYS_FORMAT_DETAIL SFD
LEFT JOIN SYS_MENU SM ON SM.ID = SFD.SM_ID


v_process_definition

CREATE OR REPLACE VIEW V_PROCESS_DEFINITION AS
SELECT SPD.* FROM SYS_PROCESS_DEFINITION SPD


v_process_step

CREATE OR REPLACE VIEW V_PROCESS_STEP AS
SELECT SPS.*,SR.SR_NAME
FROM SYS_PROCESS_STEP SPS
LEFT JOIN SYS_ROLE SR ON SR.ID = SPS.SR_ID


v_process_schedule

CREATE OR REPLACE VIEW V_PROCESS_SCHEDULE AS
SELECT SPS.*,SPD.SPD_NAME,SAI.SAI_NAME AS INITIATOR_NAME,SAIC.SAI_NAME CANCEL_NAME,SPSC.ID AS SPSC_ID,SPSC.SPSC_REASON,SPSC.SPSC_ENTRY_TIME,SDI.SDI_NAME AS PROCESS_STATUS_NAME,SPT.SPS_NAME AS STEP_NAME
FROM SYS_PROCESS_SCHEDULE SPS
LEFT JOIN SYS_PROCESS_STEP SPT ON SPT.ID = SPS.SPS_ID
LEFT JOIN SYS_PROCESS_DEFINITION SPD ON SPD.ID = SPS.SPD_ID
LEFT JOIN SYS_PROCESS_SCHEDULE_CANCEL SPSC ON SPSC.SPS_ID = SPS.ID
LEFT JOIN SYS_ACCOUNT_INFO SAI ON SAI.SO_ID = SPS.SO_ID
LEFT JOIN SYS_ACCOUNT_INFO SAIC ON SAIC.SO_ID = SPSC.SO_ID
LEFT JOIN SYS_DICT_INFO SDI ON SDI.SDT_CODE = 'SYS_PROCESS_STATUS' AND SDI.SDI_CODE = SPS.SPS_AUDIT_STATUS

v_division

CREATE OR REPLACE VIEW V_DIVISION AS
SELECT BD.*,PBD.BD_NAME AS BD_PARENT_NAME
FROM BUS_DIVISION BD
LEFT JOIN BUS_DIVISION PBD ON PBD.ID = BD.BD_PARENT_ID

v_division_personnel

CREATE OR REPLACE VIEW V_DIVISION_PERSONNEL AS
SELECT BDP.*,BD.BD_NAME
FROM BUS_DIVISION_PERSONNEL BDP
INNER JOIN BUS_DIVISION BD ON BD.ID = BDP.BD_ID


v_department

CREATE OR REPLACE VIEW V_DEPARTMENT AS
SELECT BDM.*,SDI.SDI_NAME AS BDM_COLLEGE_NAME
FROM BUS_DEPARTMENT BDM
LEFT JOIN SYS_DICT_INFO SDI ON SDI.SDT_CODE ='BUS_COLLEGE' AND SDI.SDI_CODE = BDM.BDM_COLLEGE

v_department_personnel

CREATE OR REPLACE VIEW V_DEPARTMENT_PERSONNEL AS
SELECT BDMP.*,BDM.BDM_NAME
FROM BUS_DEPARTMENT_PERSONNEL BDMP
INNER JOIN BUS_DEPARTMENT BDM ON BDM.ID = BDMP.BDM_ID

v_class

CREATE OR REPLACE VIEW V_CLASS AS
SELECT BC.*,BDM.BDM_NAME,SDI.SDI_NAME AS BC_MAJOR_NAME,ID.INSTRUCTOR_DEPARTMENT_NAME
FROM BUS_CLASS BC
INNER JOIN BUS_DEPARTMENT BDM ON BDM.ID = BC.BDM_ID
LEFT JOIN SYS_DICT_INFO SDI ON SDI.SDT_CODE ='BUS_MAJOR' AND SDI.SDI_CODE = BC.BC_MAJOR
LEFT JOIN (SELECT BA.BA_TABLE_ID,GROUP_CONCAT(SAI.SAI_NAME) AS INSTRUCTOR_DEPARTMENT_NAME FROM bus_authorization BA
           INNER JOIN sys_operator SO ON SO.ID = BA.SO_ID
           INNER JOIN sys_operator_role SOR ON SOR.SO_ID = SO.ID
           INNER JOIN sys_role SR ON SR.ID = SOR.SR_ID AND SR.SR_CODE = 'INSTRUCTOR_DEPARTMENT'
           INNER JOIN sys_account_info SAI ON SAI.SO_ID = SO.ID
           GROUP BY BA.BA_TABLE_ID)ID ON ID.BA_TABLE_ID = BC.ID

v_teacher

CREATE OR REPLACE VIEW V_TEACHER AS
SELECT BT.*,BDM.BDM_NAME
FROM BUS_TEACHER BT
INNER JOIN BUS_DEPARTMENT BDM ON BDM.ID = BT.BDM_ID

v_student

CREATE OR REPLACE VIEW V_STUDENT AS
SELECT
			BS.ID,BDM.BDM_COLLEGE,BS.BDM_ID,BS.BC_ID,BS.BS_NAME,BS.BS_NUMBER,BS.BS_LENGTH,BS.BS_ID_CARD,BS.BS_SEX,BS.BS_NATION,BS.SO_ID,
			SDI.SDI_NAME AS BS_SEX_NAME,NDI.SDI_NAME AS BS_NATION_NAME,
			BDM.BDM_NAME,BC.BC_NAME
FROM BUS_STUDENT BS
INNER JOIN BUS_DEPARTMENT BDM ON BDM.ID = BS.BDM_ID
INNER JOIN BUS_CLASS BC ON BC.ID = BS.BC_ID
LEFT JOIN SYS_DICT_INFO SDI ON SDI.SDT_CODE = 'BUS_SEX' AND SDI.SDI_CODE = BS.BS_SEX
LEFT JOIN SYS_DICT_INFO NDI ON NDI.SDT_CODE = 'BUS_NATION' AND NDI.SDI_CODE = BS.BS_NATION

v_student_attendance

CREATE OR REPLACE VIEW V_STUDENT_ATTENDANCE AS
SELECT BSA.*,BS.BS_NAME,BC.BC_NAME,
BDM.BDM_COLLEGE,BS.BDM_ID,BS.BC_ID

FROM BUS_STUDENT_ATTENDANCE BSA
INNER JOIN BUS_STUDENT BS ON BS.ID = BSA.BS_ID
INNER JOIN BUS_CLASS BC ON BC.ID = BS.BC_ID
INNER JOIN BUS_DEPARTMENT BDM ON BDM.ID = BS.BDM_ID

v_student_punishment

CREATE OR REPLACE VIEW V_STUDENT_PUNISHMENT AS
SELECT BSP.*,BS.BS_NAME,BC.BC_NAME,
BDM.BDM_COLLEGE,BS.BDM_ID,BS.BC_ID
FROM BUS_STUDENT_PUNISHMENT BSP

INNER JOIN BUS_STUDENT BS ON BS.ID = BSP.BS_ID
INNER JOIN BUS_CLASS BC ON BC.ID = BS.BC_ID
INNER JOIN BUS_DEPARTMENT BDM ON BDM.ID = BS.BDM_ID

v_student_comprehensive

CREATE OR REPLACE VIEW V_STUDENT_COMPREHENSIVE AS
SELECT
    BSC.ID,BSC.BSC_YEAR,BSC.BSC_SEMESTER,BSC.BSC_TOTAL,BSC.BSC_RANK,BSC.BSC_ACADEMIC_RECORD,BSC.BSC_INTELLECTUAL_RANK,
    BS.BS_NAME,BS.BS_NUMBER,BC.BC_NAME,
    BDM.BDM_COLLEGE,BS.BDM_ID,BS.BC_ID

FROM BUS_STUDENT_COMPREHENSIVE BSC
INNER JOIN BUS_STUDENT BS ON BS.ID = BSC.BS_ID
INNER JOIN BUS_CLASS BC ON BC.ID = BS.BC_ID
INNER JOIN BUS_DEPARTMENT BDM ON BDM.ID = BS.BDM_ID


v_aid_green_channel

CREATE OR REPLACE VIEW V_AID_GREEN_CHANNEL AS
SELECT BAF.ID,BAF.SO_ID,BAF.BS_ID,BAF.BAF_YEAR,BAF.BAF_SEMESTER,BAF.BUS_REMARKS,BAF.BUS_PROCESS,BAF.BUS_PROCESS2,BAF.BAF_ENTRY_TIME,
BS.BS_NAME,BS.BS_NUMBER,BS.SO_ID AS SHOW_SO_ID,BC.BC_NAME,BDM.BDM_NAME,
BDM.BDM_COLLEGE,BS.BDM_ID,BS.BC_ID
FROM BUS_AID_FINANCIALLY BAF
INNER JOIN BUS_STUDENT BS ON BS.ID = BAF.BS_ID
INNER JOIN BUS_CLASS BC ON BC.ID = BS.BC_ID
INNER JOIN BUS_DEPARTMENT BDM ON BDM.ID = BS.BDM_ID
WHERE BAF.BAF_TYPE = 1

v_aid_national_scholarship

CREATE OR REPLACE VIEW V_AID_NATIONAL_SCHOLARSHIP AS
SELECT BAF.ID,BAF.SO_ID,BAF.BS_ID,BAF.BAF_YEAR,BAF.BAF_SEMESTER,BAF.BUS_REMARKS,BAF.BUS_PROCESS,BAF.BUS_PROCESS2,BAF.BAF_ENTRY_TIME,
BS.BS_NAME,BS.BS_NUMBER,BS.SO_ID AS SHOW_SO_ID,BC.BC_NAME,BDM.BDM_NAME,
BDM.BDM_COLLEGE,BS.BDM_ID,BS.BC_ID,BS.BS_ID_CARD,
BANS.BANS_SCORE_RANK_TOTAL, BANS.BANS_SCORE_RANK, BANS.BANS_REQUIRED_COURSE_PASS_NUMBER, BANS.BANS_REQUIRED_COURSE_NUMBER,
BANS.BANS_IS_COMPREHENSIVE_RANK, BANS.BANS_COMPREHENSIVE_RANK, BANS.BANS_COMPREHENSIVE_RANK_NUMBER,
BANS.BANS_ACTUAL_AMOUNT, BANS.BANS_ISSUANCE_TIME
FROM BUS_AID_FINANCIALLY BAF
INNER JOIN BUS_AID_NATIONAL_SCHOLARSHIP BANS ON BANS.BAF_ID = BAF.ID
INNER JOIN BUS_STUDENT BS ON BS.ID = BAF.BS_ID
INNER JOIN BUS_CLASS BC ON BC.ID = BS.BC_ID
INNER JOIN BUS_DEPARTMENT BDM ON BDM.ID = BS.BDM_ID
WHERE BAF.BAF_TYPE = 2

v_aid_national_endeavor

CREATE OR REPLACE VIEW V_AID_NATIONAL_ENDEAVOR AS
SELECT BAF.ID,BAF.SO_ID,BAF.BS_ID,BAF.BAF_YEAR,BAF.BAF_SEMESTER,BAF.BUS_REMARKS,BAF.BUS_PROCESS,BAF.BUS_PROCESS2,BAF.BAF_ENTRY_TIME,
BS.BS_NAME,BS.BS_NUMBER,BS.SO_ID AS SHOW_SO_ID,BC.BC_NAME,BDM.BDM_NAME,
BDM.BDM_COLLEGE,BS.BDM_ID,BS.BC_ID,BS.BS_ID_CARD,
BANS.BANS_SCORE_RANK_TOTAL, BANS.BANS_SCORE_RANK, BANS.BANS_REQUIRED_COURSE_PASS_NUMBER, BANS.BANS_REQUIRED_COURSE_NUMBER,
BANS.BANS_IS_COMPREHENSIVE_RANK, BANS.BANS_COMPREHENSIVE_RANK, BANS.BANS_COMPREHENSIVE_RANK_NUMBER,
BANS.BANS_ACTUAL_AMOUNT, BANS.BANS_ISSUANCE_TIME
FROM BUS_AID_FINANCIALLY BAF
INNER JOIN BUS_AID_NATIONAL_SCHOLARSHIP BANS ON BANS.BAF_ID = BAF.ID
INNER JOIN BUS_STUDENT BS ON BS.ID = BAF.BS_ID
INNER JOIN BUS_CLASS BC ON BC.ID = BS.BC_ID
INNER JOIN BUS_DEPARTMENT BDM ON BDM.ID = BS.BDM_ID
WHERE BAF.BAF_TYPE = 3

v_aid_national_grants

CREATE OR REPLACE VIEW V_AID_NATIONAL_GRANTS AS
SELECT BAF.ID,BAF.SO_ID,BAF.BS_ID,BAF.BAF_YEAR,BAF.BAF_SEMESTER,BAF.BUS_REMARKS,BAF.BUS_PROCESS,BAF.BUS_PROCESS2,BAF.BAF_ENTRY_TIME,
BS.BS_NAME,BS.BS_NUMBER,BS.SO_ID AS SHOW_SO_ID,BC.BC_NAME,BDM.BDM_NAME,
BDM.BDM_COLLEGE,BS.BDM_ID,BS.BC_ID,BS.BS_ID_CARD,
BANG.BANG_FUNDING_STANDARDS,BANG.BANG_AMOUNT_PAYABLE,BANG.BANG_ACTUAL_AMOUNT,
BANG.BANG_APPLY_REASONS,BANG.BANG_ISSUANCE_TIME
FROM BUS_AID_FINANCIALLY BAF
INNER JOIN BUS_AID_NATIONAL_GRANTS BANG ON BANG.BAF_ID = BAF.ID
INNER JOIN BUS_STUDENT BS ON BS.ID = BAF.BS_ID
INNER JOIN BUS_CLASS BC ON BC.ID = BS.BC_ID
INNER JOIN BUS_DEPARTMENT BDM ON BDM.ID = BS.BDM_ID
WHERE BAF.BAF_TYPE = 4

v_aid_tuition_waiver

CREATE OR REPLACE VIEW V_AID_TUITION_WAIVER AS
SELECT BAF.ID,BAF.SO_ID,BAF.BS_ID,BAF.BAF_YEAR,BAF.BAF_SEMESTER,BAF.BAF_AID_TYPE,BAF.BAF_REDUCTION_QUOTA,BAF.BUS_REMARKS,BAF.BUS_PROCESS,BAF.BUS_PROCESS2,BAF.BAF_ENTRY_TIME,
BS.BS_NAME,BS.BS_NUMBER,BS.SO_ID AS SHOW_SO_ID,BC.BC_NAME,BDM.BDM_NAME,
BDM.BDM_COLLEGE,BS.BDM_ID,BS.BC_ID
FROM BUS_AID_FINANCIALLY BAF
INNER JOIN BUS_STUDENT BS ON BS.ID = BAF.BS_ID
INNER JOIN BUS_CLASS BC ON BC.ID = BS.BC_ID
INNER JOIN BUS_DEPARTMENT BDM ON BDM.ID = BS.BDM_ID
WHERE BAF.BAF_TYPE = 7

v_aid_jobseeker_support

CREATE OR REPLACE VIEW V_AID_JOBSEEKER_SUPPORT AS
SELECT BAF.ID,BAF.SO_ID,BAF.BS_ID,BAF.BAF_YEAR,BAF.BAF_SEMESTER,BAF.BAF_AID_TYPE,BAF.BAF_DIFFICULTY_QUOTA,BAF.BUS_REMARKS,BAF.BUS_PROCESS,BAF.BUS_PROCESS2,BAF.BAF_ENTRY_TIME,
BS.BS_NAME,BS.BS_NUMBER,BS.SO_ID AS SHOW_SO_ID,BC.BC_NAME,BDM.BDM_NAME,
BDM.BDM_COLLEGE,BS.BDM_ID,BS.BC_ID
FROM BUS_AID_FINANCIALLY BAF
INNER JOIN BUS_STUDENT BS ON BS.ID = BAF.BS_ID
INNER JOIN BUS_CLASS BC ON BC.ID = BS.BC_ID
INNER JOIN BUS_DEPARTMENT BDM ON BDM.ID = BS.BDM_ID
WHERE BAF.BAF_TYPE = 11

v_aid_emergency_help

CREATE OR REPLACE VIEW V_AID_EMERGENCY_HELP AS
SELECT BAF.ID,BAF.SO_ID,BAF.BS_ID,BAF.BAF_YEAR,BAF.BAF_SEMESTER,BAF.BAF_AID_TYPE,BAF.BAF_DIFFICULTY_QUOTA,BAF.BUS_REMARKS,BAF.BUS_PROCESS,BAF.BUS_PROCESS2,BAF.BAF_ENTRY_TIME,
BS.BS_NAME,BS.BS_NUMBER,BS.SO_ID AS SHOW_SO_ID,BC.BC_NAME,BDM.BDM_NAME,
BDM.BDM_COLLEGE,BS.BDM_ID,BS.BC_ID
FROM BUS_AID_FINANCIALLY BAF
INNER JOIN BUS_STUDENT BS ON BS.ID = BAF.BS_ID
INNER JOIN BUS_CLASS BC ON BC.ID = BS.BC_ID
INNER JOIN BUS_DEPARTMENT BDM ON BDM.ID = BS.BDM_ID
WHERE BAF.BAF_TYPE = 13

v_aid_college_scholarship

CREATE OR REPLACE VIEW V_AID_COLLEGE_SCHOLARSHIP AS
SELECT BAF.ID,BAF.SO_ID,BAF.BS_ID,BAF.BAF_YEAR,BAF.BAF_SEMESTER,BAF.BAF_AID_TYPE,BAF.BUS_PROCESS,BAF.BUS_PROCESS2,BAF.BAF_ENTRY_TIME,
BS.BS_NAME,BS.BS_NUMBER,BS.SO_ID AS SHOW_SO_ID,BC.BC_NAME,
BDM.BDM_COLLEGE,BS.BDM_ID,BS.BC_ID,
BSC.BSC_TOTAL,BSC.BSC_RANK,BSC.BSC_ACADEMIC_RECORD,BSC.BSC_INTELLECTUAL_RANK
FROM BUS_AID_FINANCIALLY BAF
INNER JOIN BUS_STUDENT BS ON BS.ID = BAF.BS_ID
INNER JOIN BUS_CLASS BC ON BC.ID = BS.BC_ID
INNER JOIN BUS_DEPARTMENT BDM ON BDM.ID = BS.BDM_ID
INNER JOIN BUS_STUDENT_COMPREHENSIVE BSC ON BSC.BS_ID = BAF.BS_ID AND BSC.BSC_YEAR = BAF.BAF_YEAR AND BSC.BSC_SEMESTER = BAF.BAF_SEMESTER
WHERE BAF.BAF_TYPE = 9

需要平均一年的成绩 排名

v_aid_commend

CREATE OR REPLACE VIEW V_AID_COMMEND AS
SELECT BAF.ID,BAF.SO_ID,BAF.BS_ID,BAF.BAF_YEAR,BAF.BAF_SEMESTER,BAF.BAF_AID_TYPE,BAF.BUS_PROCESS,BAF.BUS_PROCESS2,BAF.BAF_ENTRY_TIME,
BS.BS_NAME,BS.BS_NUMBER,BS.SO_ID AS SHOW_SO_ID,BC.BC_NAME,
BDM.BDM_COLLEGE,BS.BDM_ID,BS.BC_ID,
VSAY.BSC_TOTAL,VSAY.BSC_TOTAL_RANK,VSAY.BSC_ACADEMIC_RECORD,VSAY.BSC_ACADEMIC_RECORD_RANK
FROM BUS_AID_FINANCIALLY BAF
INNER JOIN BUS_STUDENT BS ON BS.ID = BAF.BS_ID
INNER JOIN BUS_CLASS BC ON BC.ID = BS.BC_ID
INNER JOIN BUS_DEPARTMENT BDM ON BDM.ID = BS.BDM_ID
INNER JOIN (SELECT
            	BSC.BS_ID AS BS_ID,
            	BSC.BC_ID AS BC_ID,
            	BSC.BSC_YEAR AS BSC_YEAR,
            	BSC.BSC_TOTAL AS BSC_TOTAL,
            	BSC.BSC_ACADEMIC_RECORD AS BSC_ACADEMIC_RECORD,
            	(
            	SELECT
            	    COUNT(*) + 1
            	FROM
            		(
            		SELECT
            			BSC.BS_ID AS BS_ID,
            			BS.BC_ID AS BC_ID,
            			BSC.BSC_YEAR AS BSC_YEAR,
            			AVG( BSC.BSC_TOTAL ) AS BSC_TOTAL
            		FROM
            			( BUS_STUDENT_COMPREHENSIVE BSC JOIN BUS_STUDENT BS ON ( ( BS.ID = BSC.BS_ID ) ) )
            		GROUP BY
            			BSC.BS_ID,
            			BSC.BSC_YEAR
            		) S
            	WHERE
            			S.BC_ID = BSC.BC_ID
            			AND S.BSC_YEAR = BSC.BSC_YEAR
            			AND S.BSC_TOTAL > BSC.BSC_TOTAL
            	) AS BSC_TOTAL_RANK,
            	(
            	SELECT
            		 COUNT(*) + 1
            	FROM
            		(
            		SELECT
            			BSC.BS_ID AS BS_ID,
            			BS.BC_ID AS BC_ID,
            			BSC.BSC_YEAR AS BSC_YEAR,
            			AVG( BSC.BSC_TOTAL ) AS BSC_TOTAL,
            			AVG( BSC.BSC_ACADEMIC_RECORD ) AS BSC_ACADEMIC_RECORD
            		FROM
            			BUS_STUDENT_COMPREHENSIVE BSC JOIN BUS_STUDENT BS ON BS.ID = BSC.BS_ID
            		GROUP BY
            			BSC.BS_ID,
            			BSC.BSC_YEAR
            		) S
            	WHERE

            			S.BC_ID = BSC.BC_ID
            			AND S.BSC_YEAR = BSC.BSC_YEAR
            			AND S.BSC_ACADEMIC_RECORD > BSC.BSC_ACADEMIC_RECORD
            	) AS BSC_ACADEMIC_RECORD_RANK
            FROM
            	(
            	SELECT
            		BSC.BS_ID AS BS_ID,
            		BS.BC_ID AS BC_ID,
            		BSC.BSC_YEAR AS BSC_YEAR,
            		AVG( BSC.BSC_TOTAL ) AS BSC_TOTAL,
            		AVG( BSC.BSC_ACADEMIC_RECORD ) AS BSC_ACADEMIC_RECORD
            	FROM
            		BUS_STUDENT_COMPREHENSIVE BSC JOIN BUS_STUDENT BS ON BS.ID = BSC.BS_ID
            	GROUP BY
            		BSC.BS_ID,
            	BSC.BSC_YEAR
            	) BSC) VSAY ON VSAY.BS_ID = BAF.BS_ID AND VSAY.BSC_YEAR = BAF.BAF_YEAR

WHERE BAF.BAF_TYPE = 10

v_student_avg_year

CREATE OR REPLACE VIEW V_STUDENT_AVG_YEAR AS
SELECT
	BSC.BS_ID AS BS_ID,
	BSC.BC_ID AS BC_ID,
	BSC.BSC_YEAR AS BSC_YEAR,
	BSC.BSC_TOTAL AS BSC_TOTAL,
	BSC.BSC_ACADEMIC_RECORD AS BSC_ACADEMIC_RECORD,
	(
	SELECT
	    COUNT(*) + 1
	FROM
		(
		SELECT
			BSC.BS_ID AS BS_ID,
			BS.BC_ID AS BC_ID,
			BSC.BSC_YEAR AS BSC_YEAR,
			AVG( BSC.BSC_TOTAL ) AS BSC_TOTAL
		FROM
			( BUS_STUDENT_COMPREHENSIVE BSC JOIN BUS_STUDENT BS ON ( ( BS.ID = BSC.BS_ID ) ) )
		GROUP BY
			BSC.BS_ID,
			BSC.BSC_YEAR
		) S
	WHERE
			S.BC_ID = BSC.BC_ID
			AND S.BSC_YEAR = BSC.BSC_YEAR
			AND S.BSC_TOTAL > BSC.BSC_TOTAL
	) AS BSC_TOTAL_RANK,
	(
	SELECT
		 COUNT(*) + 1
	FROM
		(
		SELECT
			BSC.BS_ID AS BS_ID,
			BS.BC_ID AS BC_ID,
			BSC.BSC_YEAR AS BSC_YEAR,
			AVG( BSC.BSC_TOTAL ) AS BSC_TOTAL,
			AVG( BSC.BSC_ACADEMIC_RECORD ) AS BSC_ACADEMIC_RECORD
		FROM
			BUS_STUDENT_COMPREHENSIVE BSC JOIN BUS_STUDENT BS ON BS.ID = BSC.BS_ID
		GROUP BY
			BSC.BS_ID,
			BSC.BSC_YEAR
		) S
	WHERE

			S.BC_ID = BSC.BC_ID
			AND S.BSC_YEAR = BSC.BSC_YEAR
			AND S.BSC_ACADEMIC_RECORD > BSC.BSC_ACADEMIC_RECORD
	) AS BSC_ACADEMIC_RECORD_RANK
FROM
	(
	SELECT
		BSC.BS_ID AS BS_ID,
		BS.BC_ID AS BC_ID,
		BSC.BSC_YEAR AS BSC_YEAR,
		AVG( BSC.BSC_TOTAL ) AS BSC_TOTAL,
		AVG( BSC.BSC_ACADEMIC_RECORD ) AS BSC_ACADEMIC_RECORD
	FROM
		BUS_STUDENT_COMPREHENSIVE BSC JOIN BUS_STUDENT BS ON BS.ID = BSC.BS_ID
	GROUP BY
		BSC.BS_ID,
	BSC.BSC_YEAR
	) BSC

v_log_see

CREATE OR REPLACE VIEW V_LOG_SEE AS
SELECT SL.ID,SL.SO_ID,SL.SL_NAME,SL.SL_EVENT,SL.SL_IP,SL.SL_RESULT,SL.SL_ENTERTIME,SL.SL_ENTERTIME AS SL_ENDTIME,
       SLT.SLT_CONTENT,SAI.SAI_NAME
FROM SYS_LOG SL
LEFT JOIN SYS_LOG_TEXT SLT ON SLT.SL_ID = SL.ID
LEFT JOIN SYS_ACCOUNT_INFO SAI ON SAI.SO_ID = SL.SO_ID
WHERE SL.SL_TYPE = 0

v_log_system

CREATE OR REPLACE VIEW V_LOG_SYSTEM AS
SELECT SL.ID,SL.SO_ID,SL.SL_NAME,SL.SL_EVENT,SL.SL_IP,SL.SL_RESULT,SL.SL_ENTERTIME,SL.SL_ENTERTIME AS SL_ENDTIME,
       SLT.SLT_CONTENT,SAI.SAI_NAME
FROM SYS_LOG SL
LEFT JOIN SYS_LOG_TEXT SLT ON SLT.SL_ID = SL.ID
LEFT JOIN SYS_ACCOUNT_INFO SAI ON SAI.SO_ID = SL.SO_ID
WHERE SL.SL_TYPE = 1

v_log_use

CREATE OR REPLACE VIEW V_LOG_USE AS
SELECT SL.ID,SL.SO_ID,SL.SL_NAME,SL.SL_EVENT,SL.SL_IP,SL.SL_RESULT,SL.SL_ENTERTIME,SL.SL_ENTERTIME AS SL_ENDTIME,
       SLT.SLT_CONTENT,SAI.SAI_NAME
FROM SYS_LOG SL
LEFT JOIN SYS_LOG_TEXT SLT ON SLT.SL_ID = SL.ID
LEFT JOIN SYS_ACCOUNT_INFO SAI ON SAI.SO_ID = SL.SO_ID
WHERE SL.SL_TYPE = 2

v_log_personal

CREATE OR REPLACE VIEW V_LOG_PERSONAL AS
SELECT SL.ID,SL.SO_ID,SL.SL_NAME,SL.SL_EVENT,SL.SL_IP,SL.SL_RESULT,SL.SL_ENTERTIME,SL.SL_ENTERTIME AS SL_ENDTIME,
       SLT.SLT_CONTENT,SAI.SAI_NAME
FROM SYS_LOG SL
LEFT JOIN SYS_LOG_TEXT SLT ON SLT.SL_ID = SL.ID
LEFT JOIN SYS_ACCOUNT_INFO SAI ON SAI.SO_ID = SL.SO_ID
WHERE SL.SL_TYPE = 9


v_log_value_record

CREATE OR REPLACE VIEW V_LOG_VALUE_RECORD AS
SELECT
		SVRC.SVR_TABLE_ID AS ID,SVRC.SVR_TABLE_ID AS SVR_TABLE,SVRC.SVR_TABLE_NAME,SVRC.SVR_ENTRY_TIME,SVRC.SVR_ENTRY_TIME AS SVR_END_TIME,SVRC.SO_ID,SVRC.SVR_TYPE,SVRC.SVR_OLD_VALUE,SVRC.SVR_NEW_VALUE,
		SAI.SAI_NAME
FROM(
		SELECT SVR.SVR_TABLE_ID,SVR.SVR_TABLE_NAME,MAX(SVR.SVR_ENTRY_TIME) AS SVR_ENTRY_TIME
		FROM SYS_VALUE_RECORD SVR
		GROUP BY SVR.SVR_TABLE_NAME,SVR.SVR_TABLE_ID
)SVR JOIN SYS_VALUE_RECORD SVRC ON SVRC.SVR_TABLE_ID = SVR.SVR_TABLE_ID AND SVRC.SVR_TABLE_NAME = SVR.SVR_TABLE_NAME AND SVRC.SVR_ENTRY_TIME = SVR.SVR_ENTRY_TIME
LEFT JOIN SYS_ACCOUNT_INFO SAI ON SAI.SO_ID = SVRC.SO_ID

v_log_value_record_detail

CREATE OR REPLACE VIEW V_LOG_VALUE_RECORD_DETAIL AS
SELECT SVR.*,SAI.SAI_NAME
FROM SYS_VALUE_RECORD SVR
LEFT JOIN SYS_ACCOUNT_INFO SAI ON SAI.SO_ID = SVR.SO_ID